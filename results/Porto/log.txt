2026-02-20 00:27:11,838 INFO {'dataset': 'Porto', 'min_lat': 41.142, 'min_lng': -8.652, 'max_lat': 41.174, 'max_lng': -8.578, 'grid_size': 50, 'hid_dim': 512, 'id_size': 13696, 'n_epochs': 30, 'batch_size': 256, 'learning_rate': 0.001, 'tf_ratio': 0.5, 'clip': 1, 'log_step': 1, 'diff_T': 500, 'beta_start': 0.0001, 'beta_end': 0.02, 'pre_trained_dim': 64, 'rdcl': 10, 'max_xid': 72, 'max_yid': 127}
2026-02-20 00:27:17,126 INFO modelDiff_RNTraj(
  (diff_model): diff_CSDI(
    (diffusion_embedding): DiffusionEmbedding(
      (projection1): Linear(in_features=512, out_features=512, bias=True)
      (projection2): Linear(in_features=512, out_features=512, bias=True)
    )
    (input_projection): Conv1d(65, 512, kernel_size=(1,), stride=(1,))
    (output_projection1): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
    (output_projection2): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
    (output_layer): Linear(in_features=512, out_features=65, bias=True)
    (residual_layers): ModuleList(
      (0): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (1): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (2): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(4,), dilation=(4,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (3): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(8,), dilation=(8,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (4): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (5): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (6): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(4,), dilation=(4,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (7): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(8,), dilation=(8,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (8): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (9): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
    )
    (rnn): GRU(512, 512)
    (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (out_bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (layernorm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
)
2026-02-20 00:31:17,547 INFO {'dataset': 'Porto', 'min_lat': 41.142, 'min_lng': -8.652, 'max_lat': 41.174, 'max_lng': -8.578, 'grid_size': 50, 'hid_dim': 512, 'id_size': 13696, 'n_epochs': 30, 'batch_size': 256, 'learning_rate': 0.001, 'tf_ratio': 0.5, 'clip': 1, 'log_step': 1, 'diff_T': 500, 'beta_start': 0.0001, 'beta_end': 0.02, 'pre_trained_dim': 64, 'rdcl': 10, 'max_xid': 72, 'max_yid': 127}
2026-02-20 00:31:22,827 INFO modelDiff_RNTraj(
  (diff_model): diff_CSDI(
    (diffusion_embedding): DiffusionEmbedding(
      (projection1): Linear(in_features=512, out_features=512, bias=True)
      (projection2): Linear(in_features=512, out_features=512, bias=True)
    )
    (input_projection): Conv1d(65, 512, kernel_size=(1,), stride=(1,))
    (output_projection1): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
    (output_projection2): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
    (output_layer): Linear(in_features=512, out_features=65, bias=True)
    (residual_layers): ModuleList(
      (0): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (1): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (2): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(4,), dilation=(4,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (3): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(8,), dilation=(8,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (4): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (5): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (6): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(4,), dilation=(4,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (7): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(8,), dilation=(8,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (8): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
      (9): Residual_block(
        (fc_t): Linear(in_features=512, out_features=512, bias=True)
        (dilated_conv_layer): Conv(
          (conv): Conv1d(512, 1024, kernel_size=(3,), stride=(1,), padding=(2,), dilation=(2,))
        )
        (upsample_conv2d): ModuleList(
          (0-1): 2 x ConvTranspose2d(1, 1, kernel_size=(3, 32), stride=(1, 16), padding=(1, 8))
        )
        (mel_conv): Conv(
          (conv): Conv1d(80, 1024, kernel_size=(1,), stride=(1,))
        )
        (res_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
        (skip_conv): Conv1d(512, 512, kernel_size=(1,), stride=(1,))
      )
    )
    (rnn): GRU(512, 512)
    (bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (out_bn): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (layernorm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
)
2026-02-20 00:38:01,356 INFO Epoch: 1 Time: 6m36s
2026-02-20 00:38:01,404 INFO log_vars:[tensor([1.], device='cuda:0', grad_fn=<PowBackward0>), tensor([1.], device='cuda:0', grad_fn=<PowBackward0>)]
2026-02-20 00:38:01,404 INFO 	Train Loss:5287.3445373995155	Train Const Loss:5287.006970260223	Train Diff Loss:0.19757720698311676	Train X0 Loss:0.14000011583509747
2026-02-20 00:44:40,807 INFO Epoch: 2 Time: 6m38s
2026-02-20 00:44:40,811 INFO log_vars:[tensor([1.], device='cuda:0', grad_fn=<PowBackward0>), tensor([1.], device='cuda:0', grad_fn=<PowBackward0>)]
2026-02-20 00:44:40,812 INFO 	Train Loss:4430.565450518437	Train Const Loss:4430.37407063197	Train Diff Loss:0.12188263280060987	Train X0 Loss:0.06949637782306421
